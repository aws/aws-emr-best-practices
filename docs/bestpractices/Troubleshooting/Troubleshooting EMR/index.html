<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-bestpractices/Troubleshooting/Troubleshooting EMR" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Resource contention | AWS Open Data Analytics</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://aws.github.io/aws-emr-best-practices/img/AWS_logo_RGB.png"><meta data-rh="true" name="twitter:image" content="https://aws.github.io/aws-emr-best-practices/img/AWS_logo_RGB.png"><meta data-rh="true" property="og:url" content="https://aws.github.io/aws-emr-best-practices/docs/bestpractices/Troubleshooting/Troubleshooting EMR"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Resource contention | AWS Open Data Analytics"><meta data-rh="true" name="description" content="*Overview*"><meta data-rh="true" property="og:description" content="*Overview*"><link data-rh="true" rel="canonical" href="https://aws.github.io/aws-emr-best-practices/docs/bestpractices/Troubleshooting/Troubleshooting EMR"><link data-rh="true" rel="alternate" href="https://aws.github.io/aws-emr-best-practices/docs/bestpractices/Troubleshooting/Troubleshooting EMR" hreflang="en"><link data-rh="true" rel="alternate" href="https://aws.github.io/aws-emr-best-practices/docs/bestpractices/Troubleshooting/Troubleshooting EMR" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-MF59LKNSDN","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script><link rel="stylesheet" href="/aws-emr-best-practices/assets/css/styles.28ef5182.css">
<script src="/aws-emr-best-practices/assets/js/runtime~main.61a46e42.js" defer="defer"></script>
<script src="/aws-emr-best-practices/assets/js/main.82d975cf.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/aws-emr-best-practices/"><b class="navbar__title text--truncate">AWS Open Data Analytics</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/aws-emr-best-practices/docs/bestpractices/introduction">Best Practices</a><a class="navbar__item navbar__link" href="/aws-emr-best-practices/docs/benchmarks/introduction">Benchmarks</a><a class="navbar__item navbar__link" href="/aws-emr-best-practices/docs/migration/introduction">Migration</a><a class="navbar__item navbar__link" href="/aws-emr-best-practices/docs/utilities/introduction">Utilities</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/aws-emr-best-practices/docs/bestpractices/introduction">EMR Best Practices</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/aws-emr-best-practices/docs/bestpractices/Applications/HBase/introduction">Applications</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/aws-emr-best-practices/docs/bestpractices/Cost Optimizations/Introduction">Cost Optimizations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/aws-emr-best-practices/docs/bestpractices/Features/EMRFS/aimd">Features</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/aws-emr-best-practices/docs/bestpractices/Observability/best_practices">Observability</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/aws-emr-best-practices/docs/bestpractices/Reliability/introduction">Reliability</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/aws-emr-best-practices/docs/bestpractices/Security/introduction">Security</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/aws-emr-best-practices/docs/bestpractices/Troubleshooting/Troubleshooting EMR">Troubleshooting</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/aws-emr-best-practices/docs/bestpractices/Troubleshooting/Troubleshooting EMR">Resource contention</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/aws-emr-best-practices/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Troubleshooting</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Resource contention</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Resource contention</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview"><strong><strong>Overview</strong></strong><a href="#overview" class="hash-link" aria-label="Direct link to overview" title="Direct link to overview">​</a></h2>
<p>This structured guide provides strategies to maintain peak performance and reliability in EMR with steps to help you identify, diagnose, and resolve common EMR cluster problems stemming from performance issues related to disk space, CPU utilization, and memory usage. Throughout the guide, you&#x27;ll find preventive measures to implement for long-term cluster health and application resilliency and information about additional tools and resources.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="getting-started">Getting Started<a href="#getting-started" class="hash-link" aria-label="Direct link to Getting Started" title="Direct link to Getting Started">​</a></h2>
<p>Begin by reviewing common errors and known issues, including how to locate and analyze EMR/Hadoop logs. This initial section introduces key resources: AWS re<!-- -->:Post<!-- --> for community-driven solutions, existing AWS documentation for official guidance, and Amazon Q, which provides assistance for EMR-related queries and troubleshooting. Next, navigate to the specific section that addresses your cluster&#x27;s symptoms, whether they&#x27;re related to disk space, CPU utilization, or memory usage. For each of these areas, you&#x27;ll find resource-specific diagnostics, including relevant commands, metrics, and log analysis techniques to apply as you progress.</p>
<p>To enhance your troubleshooting capabilities even further, review the provided automation tools such as SAW (Support Automation Workflow) for EMR log analysis, and leverage Knowledge Center (KC) articles for efficient log searching and querying. The guide also covers how to interpret and use node-level monitoring solutions for proactive issue detection.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="addressing-common-emr-cluster-errors-and-known-issues">Addressing Common EMR Cluster Errors and Known Issues<a href="#addressing-common-emr-cluster-errors-and-known-issues" class="hash-link" aria-label="Direct link to Addressing Common EMR Cluster Errors and Known Issues" title="Direct link to Addressing Common EMR Cluster Errors and Known Issues">​</a></h2>
<p>You can troubleshoot common EMR cluster issues using EMR <a href="https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-troubleshoot.html" target="_blank" rel="noopener noreferrer">troubleshooting documentation</a> and using solutions on AWS <a href="https://repost.aws/" target="_blank" rel="noopener noreferrer">re<!-- -->:Post</a>. These resources provide comprehensive guidance for resolving known EMR problems efficiently and information on available EMR tools for effective cluster troubleshooting. Subsequent sections cover using Amazon Q for EMR troubleshooting and analyzing Hadoop and EMR logs to investigate issues.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="amazon-q-for-emr-troubleshooting">Amazon Q for EMR troubleshooting<a href="#amazon-q-for-emr-troubleshooting" class="hash-link" aria-label="Direct link to Amazon Q for EMR troubleshooting" title="Direct link to Amazon Q for EMR troubleshooting">​</a></h3>
<p>You can ask Amazon Q about AWS architecture, best practices, support, and documentation. Amazon Q can provide you answer from the related AWS documentation or resources. Please review the provided information and determine if it helps to troubleshoot issue you are facing. If it is not helpful, you can rephrase the question.</p>
<p>To chat with Amazon Q Developer in the AWS Management Console, choose the Amazon Q icon in the right sidebar. To chat on the AWS website or any AWS service’s documentation page, choose the Amazon Q icon in the bottom right corner. You can refer <a href="https://docs.aws.amazon.com/amazonq/latest/qdeveloper-ug/chat-with-q.html#working-with-q" target="_blank" rel="noopener noreferrer">Working with Amazon Q on AWS websites</a> for more information. Below examples shows the sample questions.</p>
<p>Examples:</p>
<ol>
<li>My EMR cluster is terminated with the error <code>NO_SLAVE_LEFT</code>. Can you please help me to troubleshoot the error?</li>
<li>My EMR cluster failed with the error <code>EC2 QUOTA EXCEEDED</code>. Can you please help to troubleshoot it?</li>
</ol>
<p><img decoding="async" loading="lazy" alt="image" src="/aws-emr-best-practices/assets/images/AmazonQ-1ec0768eabede4a2797416f2dff1d52e.png" width="1189" height="468" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshot-logs-on-emr">Troubleshot logs on EMR<a href="#troubleshot-logs-on-emr" class="hash-link" aria-label="Direct link to Troubleshot logs on EMR" title="Direct link to Troubleshot logs on EMR">​</a></h3>
<p>Amazon EMR and Hadoop both produce log files that report status on the cluster. By default, these are written to the primary node in the <code>/mnt/var/log/</code> directory. Depending on how you configured your cluster when you launched it, these logs may also be archived to Amazon S3 and may be viewable through the graphical debugging tool. To understand how different type of logs are stored in EMR, please refer the details in <a href="https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-manage-view-web-log-files.html" target="_blank" rel="noopener noreferrer">View log files</a> and under <a href="https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-plan-debugging.html" target="_blank" rel="noopener noreferrer">Configure Amazon EMR cluster logging and debugging</a>. The log location where logs are stored may contain multiple files for the specific log type as the logs would be rotated. Example: Instance state logs folder may contain multiple files with the format <code>instance-state.log-YYYY-MM-DD-HH-MM</code> format. Based on timeline of issue, review the relevant logs. Subsequent sections covers how Hadoop daemon logs and EMR Instance state logs are stored on EMR and view them.</p>
<ul>
<li>
<p><strong>Viewing logs files for namenode and datanode logs in EMR</strong></p>
<ul>
<li>
<p><strong>Namenode logs:</strong></p>
<ul>
<li>Namenode logs are written to  <code>/mnt/var/log/</code> directory on the primary node or logs archived to Amazon S3.</li>
<li>Example:<!-- -->
<ul>
<li>From primary node you can find the namenode logs under the <code>/mnt/var/log/hadoop-hdfs</code> path.
<img decoding="async" loading="lazy" alt="image" src="/aws-emr-best-practices/assets/images/namnode_log_location-af89ad8738efc9c25924c67c00d84541.png" width="758" height="146" class="img_ev3q"></li>
<li>From logs that are archived to Amazon S3, you can find the namenode logs under path <code>s3://myBucket/elasticmapreduce/j-xxxxxxxxxxx/node/i-xxxxxxxxxxxxxxxxx/applications/hadoop-hdfs/</code>.  The instance id here is primary node instance id.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Datanode logs:</strong></p>
<ul>
<li>Datanode logs are written to  <code>/mnt/var/log/</code> directory on the core node or logs archived to Amazon S3.</li>
<li>Example:<!-- -->
<ul>
<li>From core node, you can find the data node logs are written to <code>/mnt/var/log/hadoop-hdfs</code> path.
<img decoding="async" loading="lazy" alt="image" src="/aws-emr-best-practices/assets/images/datanode_log_location-5e22a14e9b4c3fa30a51717dc71f14a4.png" width="697" height="130" class="img_ev3q"></li>
<li>From logs that are archived to Amazon S3, you can find the datanode logs under path <code>s3://myBucket/elasticmapreduce/j-xxxxxxxxxxx/node/i-xxxxxxxxxxxxxxxxx/applications/hadoop-hdfs/</code>.  The instance id here is core node instance id.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Viewing logs files for resourcemanager and nodemanager</strong></p>
<ul>
<li>
<p><strong>Resourcemanager logs:</strong></p>
<ul>
<li>Resourcemanager logs are written to <code>/mnt/var/log/</code> directory on the primary node or logs archived to Amazon S3.</li>
<li>Example:<!-- -->
<ul>
<li>From primary node you can find the resource manager logs under the <code>/mnt/var/log/hadoop-yarn</code> path.
<img decoding="async" loading="lazy" alt="image" src="/aws-emr-best-practices/assets/images/resourcemanager_log_location-3ccdfeeab98f834c3f7e6018c86ba4b3.png" width="641" height="137" class="img_ev3q"></li>
<li>From logs that are archived to Amazon S3, you can find the resource manager logs under path  <code>s3://myBucket/elasticmapreduce/j-xxxxxxxxxxx/node/i-xxxxxxxxxxxxxxxxx/applications/hadoop-yarn/</code>. The instance id here is primary node instance id.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Nodemanager logs:</strong></p>
<ul>
<li>Nodemanager logs are written to  <code>/mnt/var/log/</code> directory on the core(and task node if present) node or logs archived to Amazon S3.</li>
<li>Example:<!-- -->
<ul>
<li>You can check the node manager logs on the core node (and task node if present). From core or task node you can find the nodemanager logs under the <code>/mnt/var/log/hadoop-yarn</code> path.
<img decoding="async" loading="lazy" alt="image" src="/aws-emr-best-practices/assets/images/nodemanager_log_location-640870b1200471e3f64beabc750344f4.png" width="729" height="124" class="img_ev3q"></li>
<li>From logs that are archived to Amazon S3, you can find the datanode under path <code>s3://myBucket/elasticmapreduce/j-xxxxxxxxxxx/node/i-xxxxxxxxxxxxxxxxx/applications/hadoop-yarn/</code>.  The instance id here is core node instance id.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Viewing application logs:</strong></p>
<ul>
<li>
<p>You can check the relevant application logs from container folder from the logs that are archived to Amazon S3. Example bucket path - <code>s3://myBucket/elasticmapreduce/j-xxxxxxxxxxx/containers/</code></p>
</li>
<li>
<p>Example application logs:</p>
<ul>
<li>
<p>Application container logs. The container logs that ends with <code>_00001</code> is the application master log. Example <code>container_1728540895407_0001_01_000001</code>. If it is the spark job which is submitted in <code>cluster</code> mode the driver would run in the application master container.</p>
<p><img decoding="async" loading="lazy" alt="image" src="/aws-emr-best-practices/assets/images/application_master_log_location-c0fadff32e53a591a76e14875a315c1b.png" width="337" height="201" class="img_ev3q"></p>
</li>
<li>
<p>Other containers are the containers which would execute the task allocated by Application Master(AM). If it is the spark job the non AM container will run the executors.</p>
<p><img decoding="async" loading="lazy" alt="image" src="/aws-emr-best-practices/assets/images/application_container_log_location-aff357912ff4944d95a15dca8461abd5.png" width="272" height="179" class="img_ev3q"></p>
</li>
</ul>
</li>
<li>
<p>You can find the logs for specific application using <a href="https://hadoop.apache.org/docs/stable/hadoop-yarn/hadoop-yarn-site/YarnCommands.html" target="_blank" rel="noopener noreferrer">Yarn command</a> by running it on cluster node.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Example: yarn logs -applicationId (application_no)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Review the log using  persistent application user interfaces to troubleshoot the logs based on the application you used. Example: Spark, TEZ etc. <a href="https://docs.aws.amazon.com/emr/latest/ManagementGuide/app-history-spark-UI.html" target="_blank" rel="noopener noreferrer">View persistent application user interfaces</a></p>
</li>
<li>
<p>For detailed spark application troubleshooting, please refer the <a href="https://repost.aws/knowledge-center/spark-driver-logs-emr-cluster" target="_blank" rel="noopener noreferrer">article</a>. It shows how to troubleshoot the Spark application on EMR when spark job is submitted in different deployment modes.</p>
</li>
</ul>
</li>
<li>
<p><strong>Viewing instance state logs</strong></p>
<ul>
<li>You can check the instance state logs for primary or core or task node from path <code>/mnt/var/log/instance-state</code> . These contain information about the CPU, memory state, and garbage collector threads of the node.
<img decoding="async" loading="lazy" alt="image" src="/aws-emr-best-practices/assets/images/instance_state_log_location-43e0bdfe38bdc931c1121b441407728f.png" width="608" height="102" class="img_ev3q"></li>
<li>From logs that are archived to Amazon S3, you can find the instant state logs under path <code>s3://myBucket/elasticmapreduce/j-xxxxxxxxxxx/node/i-xxxxxxxxxxxxxxxxx/daemons/instance-state/</code>. Here the instance can be primary or core or task node.</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting-disk-space-related-issues-on-emr">Troubleshooting Disk space related issues on EMR<a href="#troubleshooting-disk-space-related-issues-on-emr" class="hash-link" aria-label="Direct link to Troubleshooting Disk space related issues on EMR" title="Direct link to Troubleshooting Disk space related issues on EMR">​</a></h2>
<p>EMR service emits events and metrics to CloudWatch service to track the activity and health of an Amazon EMR cluster.  Metrics are useful to monitor a specific value - for example, the percentage of available disk space that HDFS is using within a cluster. For detailed list of metrics emitted by EMR service, please refer <a href="https://docs.aws.amazon.com/emr/latest/ManagementGuide/UsingEMR_ViewingMetrics.html#UsingEMR_ViewingMetrics_MetricsReported" target="_blank" rel="noopener noreferrer">Metrics reported by Amazon EMR in CloudWatch</a>. Subsequent section shows how monitoring specific EMR cluster CloudWatch metrics - HDFSUtilization, MissingBlocks, CorruptBlocks and CapacityRemainingGB can assist with HDFS health and usage related issues.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="check-the-cluster-level-hdfs-related-metrics-to-understand-if-there-is-a-cluster-level-space-issue-and-how-to-troubleshoot-it">Check the cluster level HDFS related metrics to understand if there is a cluster level space issue <a href="https://docs.aws.amazon.com/emr/latest/ManagementGuide/UsingEMR_ViewingMetrics.html" target="_blank" rel="noopener noreferrer"></a>and how to troubleshoot it.<a href="#check-the-cluster-level-hdfs-related-metrics-to-understand-if-there-is-a-cluster-level-space-issue-and-how-to-troubleshoot-it" class="hash-link" aria-label="Direct link to check-the-cluster-level-hdfs-related-metrics-to-understand-if-there-is-a-cluster-level-space-issue-and-how-to-troubleshoot-it" title="Direct link to check-the-cluster-level-hdfs-related-metrics-to-understand-if-there-is-a-cluster-level-space-issue-and-how-to-troubleshoot-it">​</a></h3>
<ul>
<li>
<p><strong>How is HDFS setup in EMR?</strong></p>
<ul>
<li>HDFS replication factor(dfs.replication) in EMR.<!-- -->
<ul>
<li>In HDFS, the replication factor is the number of copies of each data block that are stored in HDFS for redundancy. The replication factor increases with the number of nodes in the EMR cluster (<a href="https://docs.aws.amazon.com/emr/latest/ReleaseGuide/emr-hdfs-config.html" target="_blank" rel="noopener noreferrer">default setup</a>): there are 3 copies of each data block for a cluster with 10 or more nodes, 2 copies of each block for a cluster with 4 to 9 nodes, and 1 copy (no redundancy) for clusters with 3 or fewer nodes. The total HDFS space available is divided by the replication factor.</li>
<li>Example:<!-- -->
<ul>
<li>For example, a cluster with ten core nodes of type m1.large would have 2833 GB of space available to HDFS ((10 nodes X 850 GB per node)/replication factor of 3).</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Why does HDFS show high consumption?</strong></p>
<ul>
<li>There can be different common reasons why HDFS might fill up:<!-- -->
<ul>
<li>User manually terminate cluster’s data node. This reduces overall available free space to the HDFS.</li>
<li>Specific job is writing data continuously to the HDFS and filling up space.</li>
<li>In some cases, such as increasing the number of nodes from 9 to 10, the increase in replication factor can actually cause the amount of available HDFS space to decrease.</li>
<li>In some cases, decreasing number of core nodes, for example from 10 to 5 considering replication factor setting to 3 or 2, will also lead to filling up of HDFS and cause unhealthy node related issues.</li>
<li>Data node is running in a cluster but not able to communicate to the namenode.<!-- -->
<ul>
<li>It can be due to:<!-- -->
<ul>
<li>Networking issue between namenode and datanode.</li>
<li>Due to high resource usage on data node which makes it unresponsive.</li>
<li>Infrastructure issue on the data node.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>What are the commands or utility to check HDFS filesystem, health and usage?</strong></p>
<ul>
<li>
<p>By executing HDFS <code>dfsadmin</code> and <code>fsck</code> command you can get the details of the HDFS filesystem, health and usage. Based on output of command, you can further dive deep. Monitor the CloudWatch metrics HDFSUtilisation,  MissingBlocks, CorruptBlocks and CapacityRemainingGB.</p>
</li>
<li>
<p><strong>HDFS filesystem checking utility <a href="https://hadoop.apache.org/docs/current/hadoop-project-dist/hadoop-hdfs/HDFSCommands.html#fsck" target="_blank" rel="noopener noreferrer">fsck</a></strong></p>
</li>
<li>
<p>It helps to review HDFS filesystem health. fsck can be run on the whole file system or on a subset of files. It is designed for reporting problems with various files, for example, missing blocks for a file or under-replicated blocks. <code>hdfs fsck</code> command when executed from the cluster node, will show the possible options that can be passed to <code>fsck</code> command.</p>
<ul>
<li>Example:<!-- -->
<ul>
<li>Run <code>hdfs fsck /</code> command on one of the node in cluster. It will generate the report on the overall HDFS filesystem status under the HDFS path <code>hdfs fsck /</code>. Sample output from EMR primary node would look like below.<!-- -->
<ul>
<li>
<p>Output:</p>
<p><img decoding="async" loading="lazy" alt="image" src="/aws-emr-best-practices/assets/images/hdfs_fsck-ccb769b27fa57d17f9051eb6349541a8.png" width="457" height="509" class="img_ev3q"></p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>HDFS admin command “<a href="https://hadoop.apache.org/docs/current/hadoop-project-dist/hadoop-hdfs/HDFSCommands.html#dfsadmin" target="_blank" rel="noopener noreferrer">dfsadmin</a>“</strong></p>
</li>
<li>
<p>It helps to generate HDFS usage report and perform HDFS admin level task. <code>hdfs dfsadmin</code> command when executed from the cluster node, will show the possible options that can be passed to <code>dfsadmin</code> command. <code>-report</code> option reports basic statistics of HDFS usage.</p>
<ul>
<li>Example:<!-- -->
<ul>
<li>Run <code>hdfs dfsadmin -report</code> on one of the node in cluster. It will generate the report on the overall HDFS health and usage. Sample output from EMR primary node would look like below.<!-- -->
<ul>
<li>
<p>Output:</p>
<p><img decoding="async" loading="lazy" alt="image" src="/aws-emr-best-practices/assets/images/hdfs_fsadmin-cc825c15d2a82f7cc0fc860bbce02a2d.png" width="546" height="363" class="img_ev3q"></p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Mitigate HDFS related issues</strong></p>
<ul>
<li>
<p>Review below common errors which cluster can report when HDFS usage is high and how to resolve it. HDFS related errors can be reported under the namenode logs on primary node, datanode logs on the core nodes and in the application logs. Please check the relevant logs for the error based on the issue timeline. For log review, please check the section <a href="#troubleshot-logs-on-emr">Troubleshot logs on EMR</a>.</p>
<ul>
<li><a href="https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-hdfs-insufficient-space.html" target="_blank" rel="noopener noreferrer">HDFS insufficient space error</a></li>
<li><a href="https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-troubleshoot-error-resource-2.html" target="_blank" rel="noopener noreferrer">File could only be replicated to 0 nodes instead of 1</a></li>
<li><a href="https://docs.aws.amazon.com/emr/latest/ManagementGuide/enough-hdfs-space.html" target="_blank" rel="noopener noreferrer">Cannot replicate block, only managed to replicate to zero nodes.</a></li>
<li><a href="https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-hdfs-insufficient-replication.html" target="_blank" rel="noopener noreferrer">HDFS replication factor error</a></li>
</ul>
</li>
<li>
<p>If HDFSUtilization metric is above the threshold you have set for your cluster, please review below points to troubleshoot further.</p>
<ul>
<li>Scale up the number of core nodes in your Amazon EMR cluster. If you use managed scaling or autoscaling, increase the minimum capacity of your core nodes.</li>
<li>Use larger EBS volumes for your core nodes when you create your EMR cluster.</li>
<li>Delete unneeded HDFS data in your EMR cluster.</li>
<li>If your cluster is one that can be stopped and restarted, you may consider using core nodes of a larger Amazon EC2 instance type.</li>
<li>You might also consider adjusting the replication factor. Be aware, though, that decreasing the replication factor reduces the redundancy of HDFS data and your cluster&#x27;s ability to recover from lost or corrupted HDFS blocks</li>
</ul>
</li>
<li>
<p><strong>Review HDFS MissingBlocks, CorruptBlocks and CapacityRemainingGB metrics</strong></p>
<ul>
<li>MissingBlocks metric indicates the number of blocks in which HDFS has no replicas.</li>
<li>CorruptBlocks metrics indicates the number of blocks that HDFS reports as corrupted.</li>
<li>CapacityRemainingGB indicates the available amount of remaining HDFS disk capacity.<!-- -->
<ul>
<li>If there are MissingBlocks reported, review the files for which blocks are missing.</li>
<li>If there are CorruptBlocks reported, review the cluster further for the data loss.<!-- -->
<ul>
<li>Run <code>hdfs fsck /</code> command on one of the node in cluster. It will generate the report on the overall HDFS filesystem status under the HDFS path <code>hdfs fsck /</code></li>
<li>Run <code>hdfs dfsadmin -report</code> on one of the node in cluster. It will generate the report on the overall HDFS health and usage.</li>
<li>Run <code>hdfs hdfs fsck / -files -blocks -locations</code> command. It should list all files and their blocks, including information about the corrupt replicas</li>
<li>Based on output of above commands, review the blocks those are reported as a missingblocks or corruptblocks.<!-- -->
<ul>
<li>If they are part of specific data node, please check if the data node is running or not. Check if data node is able to communicate with the name node or not.</li>
<li>If the replication factor is set to 1 and If core node is of type spot and due to spot interruption, there is chances of missing and corrupted block issues.</li>
<li>Review the cause and resolution for one of the known issue in Hadoop<!-- -->
<ul>
<li><a href="https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-troubleshoot-error-resource-2.html" target="_blank" rel="noopener noreferrer">File could only be replicated to 0 nodes instead of 1</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="check-the-cluster-level-metrics-to-understand-if-there-is-a-disk-related-issue-at-node-level-and-how-to-troubleshoot-it">Check the cluster level metrics to understand if there is a disk related issue at node level and how to troubleshoot it.<a href="#check-the-cluster-level-metrics-to-understand-if-there-is-a-disk-related-issue-at-node-level-and-how-to-troubleshoot-it" class="hash-link" aria-label="Direct link to Check the cluster level metrics to understand if there is a disk related issue at node level and how to troubleshoot it." title="Direct link to Check the cluster level metrics to understand if there is a disk related issue at node level and how to troubleshoot it.">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="why-nodes-are-considered-unhealthy">Why nodes are considered unhealthy?<a href="#why-nodes-are-considered-unhealthy" class="hash-link" aria-label="Direct link to Why nodes are considered unhealthy?" title="Direct link to Why nodes are considered unhealthy?">​</a></h4>
<ul>
<li>Nodes that have at least one Amazon Elastic Block Store (Amazon EBS) volume attached are considered unhealthy if they hit more than 90% disk utilization.</li>
<li>In Hadoop, NodeManager periodically checks the Amazon Elastic Block Store (Amazon EBS) volumes that are attached to the cluster&#x27;s nodes. If disk utilization on a node that has one volume attached is greater than the YARN property yarn.nodemanager.disk-health-checker.max-disk-utilization-per-disk-percentage (default value 90%), then the node is considered unhealthy. When a node is unhealthy, ResourceManager kills all containers running on that node. ResourceManager doesn&#x27;t schedule new containers on unhealthy nodes. You can review and set the property as per your use case. For more information, see <a href="https://hadoop.apache.org/docs/current/hadoop-yarn/hadoop-yarn-site/NodeManager.html" target="_blank" rel="noopener noreferrer">NodeManager in the Hadoop documentation</a> and yarn-site properties in <a href="https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-cluster-NO_SLAVE_LEFT-FAILED_BY_MASTER.html" target="_blank" rel="noopener noreferrer">Amazon EMR cluster terminates with NO_SLAVE_LEFT and core nodes FAILED_BY_MASTER</a>.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="how-do-i-track-lost-nodes-and-unhealthy-nodes">How do I track lost nodes and unhealthy nodes?<a href="#how-do-i-track-lost-nodes-and-unhealthy-nodes" class="hash-link" aria-label="Direct link to How do I track lost nodes and unhealthy nodes?" title="Direct link to How do I track lost nodes and unhealthy nodes?">​</a></h4>
<ul>
<li>The MRLostNodes metric tracks when one or more core or task nodes is unable to communicate with the primary node. For example, the core or task node is unreachable by the primary node.</li>
<li>The MRUnhealthyNodes metric tracks when one or more core or task nodes run out of local disk storage and transition to an UNHEALTHY YARN state. For example, core or task nodes are running low on disk space and will not be able to run tasks.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="how-do-i-identify-the-unhealthy-nodes">How do I identify the unhealthy nodes?<a href="#how-do-i-identify-the-unhealthy-nodes" class="hash-link" aria-label="Direct link to How do I identify the unhealthy nodes?" title="Direct link to How do I identify the unhealthy nodes?">​</a></h4>
<ul>
<li>If ResourceManager kills multiple executors because of unhealthy nodes, then the application fails with a &quot;slave lost&quot; error. To confirm that a node is unhealthy, review the NodeManager logs or the instance controller logs:</li>
<li>The location of the NodeManager logs is defined in the YARN_LOG_DIR variable in yarn-env.sh.</li>
<li>The instance controller logs are stored at /emr/instance-controller/log/instance-controller.log on the primary node. The instance controller logs provide an aggregated view of all the nodes of the cluster.</li>
<li>If a node is unhealthy, the logs show an entry that looks like this Y<!-- -->:U<!-- --> (U state Unhealthy),<!-- -->
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">* INFO Poller: InstanceJointStatusMap contains 40 entries (R:40):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*   i-006baxxxxxx  1829s R   1817s ig-3B ip-xxx-xx-xx-xxx I:    7s Y:U    11s c: 0 am:    0 H:R  0.0%Yarn unhealthy Reason : 1/1 local-dirs are bad: /mnt/yarn; 1/1 log-dirs are bad: /var/log/hadoop-yarn/containers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*   i-00979xxxxxx  1828s R   1817s ig-3B ip-xxx-xx-xx-xxx I:    7s Y:R     9s c: 3 am: 2048 H:R  0.0%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*   i-016c4xxxxxx  1834s R   1817s ig-3B ip-xxx-xx-xx-xxx I:   13s Y:R    14s c: 3 am: 2048 H:R  0.0%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*   i-01be3xxxxxx  1832s R   1817s ig-3B ip-xxx-xx-xx-xxx I:   10s Y:U    12s c: 0 am:    0 H:R  0.0%Yarn unhealthy Reason : 1/1 local-dirs are bad: /mnt/yarn; 1/1 log-dirs are bad: /var/log/hadoop-yarn/containers</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-troubleshoot-the-unhealthy-nodes">How to troubleshoot the unhealthy nodes?<a href="#how-to-troubleshoot-the-unhealthy-nodes" class="hash-link" aria-label="Direct link to How to troubleshoot the unhealthy nodes?" title="Direct link to How to troubleshoot the unhealthy nodes?">​</a></h4>
<ul>
<li>You can find the details related to unhealthy nodes or high disk usage,<!-- -->
<ul>
<li>In the instance-controller.log,</li>
<li>In the node manager logs,</li>
<li>By executing <code>df -h</code> command on the marked as unhealthy node.</li>
<li>By checking the instance state logs for the <code>df -h</code> command output. Check for the directories that contain the <code>mnt</code> keyword in output.</li>
</ul>
</li>
<li>Common errors which cluster can report when UNHEALTHY node state is reported due to high disk usage and how to troubleshoot it:<!-- -->
<ul>
<li><a href="https://repost.aws/knowledge-center/core-node-emr-cluster-disk-space" target="_blank" rel="noopener noreferrer">Why is the core node in my Amazon EMR cluster running out of disk space?</a></li>
<li><a href="https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-cluster-NO_SLAVE_LEFT-FAILED_BY_MASTER.html" target="_blank" rel="noopener noreferrer">Cluster terminates with NO_SLAVE_LEFT and core nodes FAILED_BY_MASTER</a></li>
<li><a href="https://repost.aws/knowledge-center/core-node-emr-cluster-disk-space" target="_blank" rel="noopener noreferrer">How do I resolve ExecutorLostFailure &quot;Slave lost&quot; errors in Spark on Amazon EMR?</a></li>
<li><a href="https://repost.aws/knowledge-center/no-space-left-on-device-emr-spark" target="_blank" rel="noopener noreferrer">How do I resolve &quot;no space left on device&quot; stage failures in Spark on Amazon EMR?</a></li>
<li><a href="https://repost.aws/knowledge-center/user-cache-disk-space-emr" target="_blank" rel="noopener noreferrer">How do I stop a Hadoop or Spark job&#x27;s user cache so that the cache doesn&#x27;t use too much disk space in Amazon EMR?</a></li>
</ul>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="review-additional-steps">Review additional steps<a href="#review-additional-steps" class="hash-link" aria-label="Direct link to Review additional steps" title="Direct link to Review additional steps">​</a></h4>
<ul>
<li>
<p>Remove unnecessary local and temporary files from the disk with high usage.</p>
</li>
<li>
<p>Add more Amazon Elastic Block Store (Amazon EBS) capacity for new cluster or running cluster(<a href="https://repost.aws/knowledge-center/no-space-left-on-device-emr-spark" target="_blank" rel="noopener noreferrer">reference</a>).</p>
</li>
<li>
<p>Dynamically scale up storage on Amazon EMR clusters.(<a href="https://aws.amazon.com/blogs/big-data/dynamically-scale-up-storage-on-amazon-emr-clusters/" target="_blank" rel="noopener noreferrer">reference</a>)</p>
</li>
<li>
<p>Check if the log files are consuming the space. Remove unnecessary log files and reduce retention period(reference)</p>
</li>
<li>
<p>Review and consider to enable property <a href="https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-plan-node-replacement.html" target="_blank" rel="noopener noreferrer">Replacing unhealthy nodes</a> for the EMR cluster.</p>
<ul>
<li>If unhealthy node replacement is on, Amazon EMR will terminate the unhealthy core node and provision a new instance based on the number of instances in the instance group or the target capacity for instance fleets</li>
</ul>
</li>
<li>
<p>Check the container logs to understand if the job is failed due to space issue and how to troubleshoot it.</p>
<ul>
<li>Check the container logs from the s3 bucket where cluster saves the application logs. You can check the relevant application logs from container folder from the logs that are archived to Amazon S3. Example bucket path - <code>s3://myBucket/elasticmapreduce/j-xxxxxxxxxxx/containers/</code></li>
<li>You can find the logs for specific application using <a href="https://hadoop.apache.org/docs/stable/hadoop-yarn/hadoop-yarn-site/YarnCommands.html" target="_blank" rel="noopener noreferrer">Yarn command</a> by running it on cluster node.<!-- -->
<ul>
<li>Example: yarn logs -applicationId (application_no)</li>
</ul>
</li>
<li>Review the log using  persistent application user interfaces to troubleshoot the logs based on the application you used. Example: Spark, TEZ etc. <a href="https://docs.aws.amazon.com/emr/latest/ManagementGuide/app-history-spark-UI.html" target="_blank" rel="noopener noreferrer">View persistent application user interfaces</a></li>
</ul>
</li>
<li>
<p>Review common errors which jobs can report in the logs related to disk space.</p>
<ul>
<li>Check If job log shows that the job failed with the <code>The application fails with a &quot;no space left on device&quot;</code> error.<!-- -->
<ul>
<li>Troubleshoot using <a href="https://repost.aws/knowledge-center/no-space-left-on-device-emr-spark" target="_blank" rel="noopener noreferrer">How do I resolve &quot;no space left on device&quot; stage failures in Spark on Amazon EMR?</a></li>
</ul>
</li>
<li>Check if job logs shows the job failed with error <code>Reason: Slave lost</code>
<ul>
<li>Troubleshoot using <a href="https://repost.aws/knowledge-center/executorlostfailure-slave-lost-emr" target="_blank" rel="noopener noreferrer">How do I resolve ExecutorLostFailure &quot;Slave lost&quot; errors in Spark on Amazon EMR ?</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting-cpu-related-issues-on-emr">Troubleshooting CPU related issues on EMR<a href="#troubleshooting-cpu-related-issues-on-emr" class="hash-link" aria-label="Direct link to Troubleshooting CPU related issues on EMR" title="Direct link to Troubleshooting CPU related issues on EMR">​</a></h2>
<p>Review the cluster level and node level metrics to understand if there is a CPU resource contention at node level or cluster level which is resulting in cluster and application slowness or failure.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="review-the-node-level-logs-and-metrics-to-understand-the-cpu-usage">Review the node level logs and metrics to understand the CPU usage<a href="#review-the-node-level-logs-and-metrics-to-understand-the-cpu-usage" class="hash-link" aria-label="Direct link to Review the node level logs and metrics to understand the CPU usage" title="Direct link to Review the node level logs and metrics to understand the CPU usage">​</a></h3>
<ul>
<li>The log and metric shall help to understand if specific process on the node is using high CPU or what is the overall CPU usage of node over specific time interval.</li>
<li>Refer - <a href="https://repost.aws/articles/AR77wVn54aSQSjLzJGTQsKEQ/decoding-instance-state-log-in-emr" target="_blank" rel="noopener noreferrer">Decoding Instance-State log in EMR</a></li>
<li>Instance state logs.<!-- -->
<ul>
<li>These log contain information about the overall cpu usage, top cpu consuming users and garbage collector threads of the node.<!-- -->
<ul>
<li>Search <code>#Top CPU users</code> in the log files to see the top memory consuming processes.</li>
<li>Search <code>load average</code> in the log files to see the load average metric.</li>
<li>Search <code>iostat</code> in the log files to see the overall cpu related metrics with the diskio for the specific period.</li>
</ul>
</li>
<li>Log contains information about the system messages.<!-- -->
<ul>
<li>Search <code>dmesg</code> in the log files to see the logged messages.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="review-load-average-metric-to-understand-the-cpu-usage">Review <code>load average</code> metric to understand the CPU usage<a href="#review-load-average-metric-to-understand-the-cpu-usage" class="hash-link" aria-label="Direct link to review-load-average-metric-to-understand-the-cpu-usage" title="Direct link to review-load-average-metric-to-understand-the-cpu-usage">​</a></h3>
<ul>
<li><strong>What does output of <code>load average</code> indicate about CPU usage?</strong>
<ul>
<li>System load averages is the average number of processes that are either in a  runnable  or  uninterruptable  state. A process  in  a runnable state is either using the CPU or waiting to use the CPU.  A process in uninterruptable state is waiting for some I/O access, eg waiting for disk.  The averages are taken over the three time intervals.  Load averages are  not  normalized for the number of CPUs in a system, so a load average of 1 means a single CPU system is loaded all the time while on a 4 CPU system it means it was idle 75% of the time.</li>
</ul>
</li>
<li><strong>How do I find the number of cores my instance has?</strong>
<ul>
<li>Check the <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/cpu-options-supported-instances-values.html" target="_blank" rel="noopener noreferrer">instance type</a> page to find out the default number of vCPU.</li>
<li>Execute command on instance - <code>grep &#x27;model name&#x27; /proc/cpuinfo | wc -l</code>. This will return number of cpus your instance have.</li>
</ul>
</li>
<li><strong>Look for the load average metric in the Instance</strong>
<ul>
<li>How do I find the load average of the instance.<!-- -->
<ul>
<li>
<p>Look for keyword <code>load average</code> in the instance state logs of instance to find the load average command output.</p>
</li>
<li>
<p>Execute the command <code>uptime</code> or <code>top</code> in instance to capture the output of load average.</p>
<p><img decoding="async" loading="lazy" alt="image" src="/aws-emr-best-practices/assets/images/uptime-730f3301122811c4737997974e20eee3.png" width="764" height="318" class="img_ev3q"></p>
</li>
<li>
<p>If your instance has 4 cpus and the output load average 0.43, 0.62, 0.71 - it suggest that CPU system is not overloaded.</p>
</li>
<li>
<p>If your instance has 4 cpus, If the output load average is 3.3, 3.8, 3,9 - it suggest that the CPU system is nearly loaded all the times and require attention.</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="review-diskio-metric-to-understand-the-cpu-usage">Review diskio metric to understand the CPU usage<a href="#review-diskio-metric-to-understand-the-cpu-usage" class="hash-link" aria-label="Direct link to Review diskio metric to understand the CPU usage" title="Direct link to Review diskio metric to understand the CPU usage">​</a></h3>
<ul>
<li>
<p><strong>Look for the diskio metric.</strong></p>
<ul>
<li>Execute <code>iostat</code> command in the instance to collect the output.
<img decoding="async" loading="lazy" alt="image" src="/aws-emr-best-practices/assets/images/iostat-7a09e664f7081f1eb49f8c106e10e3c4.png" width="790" height="175" class="img_ev3q"></li>
</ul>
</li>
<li>
<p><strong>What does output of <code>iostat</code> shows?</strong>
<img decoding="async" loading="lazy" alt="image" src="/aws-emr-best-practices/assets/images/iostat_output-812e051bfd2fb3a9d97ee51ac6664994.png" width="1459" height="386" class="img_ev3q"></p>
</li>
<li>
<p><strong>What does output of diskio metric indicate?</strong></p>
<ul>
<li>Please monitor the %iowait parameter to understand the CPU wait time while it wait for the pending diskio operation to complete. It can indicate the slow storage performance. However to understand what is the normal value of %iowait for workload please monitor system over the time. consider to use SAR command to gather the historical data.</li>
</ul>
</li>
<li>
<p><strong>Troubleshoot service or node level unresponsiveness due to high CPU usage.</strong></p>
<ul>
<li>
<p><strong>Review AppsPending and AppsCompleted to understand number of applications submitted to YARN that are in a pending state and that are getting completed.</strong></p>
</li>
<li>
<p>You can check the metrics from CloudWatch console, from Yarn RM UI or using Yarn commands <code>yarn application -appStates ALL</code>.</p>
</li>
<li>
<p>If AppsPending metric is increasing over a period and AppsCompleted metric is not increasing over a period. This indicate that new applications are going in a queue and existing application are not completing for some reason. There can be resource contention. Identify timeline since issue started.</p>
<ul>
<li>Instance state logs. These contain information about the CPU, memory state, and garbage collector threads of the node. <a href="https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-manage-view-web-log-files.html" target="_blank" rel="noopener noreferrer">View log files</a>.  <a href="https://repost.aws/articles/AR77wVn54aSQSjLzJGTQsKEQ/decoding-instance-state-log-in-emr" target="_blank" rel="noopener noreferrer">Decoding Instance-State log in EMR</a>
<ul>
<li>Check the instance state logs on the primary nodes to understand that if any of the primary service or application is using the high CPU over a period and have become unresponsive due to high CPU utilisation and resulting in primary instance becoming unresponsive.</li>
<li>Check the instance level metrics to understand if due to high CPU usage instance has become unresponsive or not. <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/viewing_metrics_with_cloudwatch.html" target="_blank" rel="noopener noreferrer">Instance level CloudWatch metrics</a>.<!-- -->
<ul>
<li>Look for keyword <code>#Top CPU users</code> in instance state logs and identify the top processes which is using high CPU.<!-- -->
<ul>
<li>Investigate process further to understand if the specific application, Hadoop daemon or container is using high CPU.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Review LiveDataNode to understand percentage of data nodes that are receiving work from Hadoop.</strong></p>
</li>
<li>
<p>You can check the metrics from CloudWatch console or using <code>hdfs dfsadmin -report</code> command.</p>
</li>
<li>
<p>If only some of the DataNodes are active, There can be resource contention. Identify timeline since issue started.</p>
<ul>
<li>Check the Instance state logs of primary or other cluster node types based on the timeline identified since the issue started. These contain information about the CPU, memory state, and garbage collector threads of the node. <a href="https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-manage-view-web-log-files.html" target="_blank" rel="noopener noreferrer">View log files</a>.</li>
<li>Check if any of service or application is using the high CPU over a period and have become unresponsive due to high CPU utilisation and resulting in  instance becoming unresponsive.<!-- -->
<ul>
<li>Look for keyword <code>#Top CPU users</code> in instance state logs and identify the top processes which is using high CPU.<!-- -->
<ul>
<li>Investigate process further to understand if the specific application, Hadoop daemon or container is using high CPU.</li>
</ul>
</li>
</ul>
</li>
<li>Check the instance level metrics as well to understand if due to high CPU usage instance has become unresponsive or not.  <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/viewing_metrics_with_cloudwatch.html" target="_blank" rel="noopener noreferrer">Instance level CloudWatch metrics</a>.<!-- -->
<ul>
<li>Check CPU usage related metric and instance health status related metrics.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting-memory-related-issues-on-emr">Troubleshooting memory related issues on EMR<a href="#troubleshooting-memory-related-issues-on-emr" class="hash-link" aria-label="Direct link to Troubleshooting memory related issues on EMR" title="Direct link to Troubleshooting memory related issues on EMR">​</a></h2>
<p>This section helps to Identify and resolve the memory related issues for the the service or application. The memory related errors can be reported into the hadoop daemon logs, application logs or EMR logs. Following section shows how you can use the node level instance state logs to find the CPU usage for specific time period. Additionally section also shows how to check the service status and troubleshoot the memory related issue with specific hadoop deamon, application and container failure.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="reviewing-memory-usage">Reviewing memory usage<a href="#reviewing-memory-usage" class="hash-link" aria-label="Direct link to Reviewing memory usage" title="Direct link to Reviewing memory usage">​</a></h3>
<ul>
<li>Check the node level logs to understand if specific process on the node is using high memory or failing with memory related issue. Refer - <a href="https://repost.aws/articles/AR77wVn54aSQSjLzJGTQsKEQ/decoding-instance-state-log-in-emr" target="_blank" rel="noopener noreferrer">Decoding Instance-State log in EMR</a></li>
<li>Instance state logs:<!-- -->
<ul>
<li>These log contain information about the overall memory usage, top memory consuming users and garbage collector threads of the node.<!-- -->
<ul>
<li>Search <code>#Top memory users</code> in the log files to see the top memory consuming processes.</li>
<li>Search <code>free -m</code> in the log files to see the overall free and used memory of node.</li>
<li>Search <code>vmstat</code> in the log files to see the overall memory stats over specific period.</li>
</ul>
</li>
<li>Log contains information about the system messages:<!-- -->
<ul>
<li>Search <code>dmesg</code> in the log files to see the logged messages.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting-a-memory-related-issue">Troubleshooting a memory related issue<a href="#troubleshooting-a-memory-related-issue" class="hash-link" aria-label="Direct link to Troubleshooting a memory related issue" title="Direct link to Troubleshooting a memory related issue">​</a></h3>
<ul>
<li>Hadoop daemon, EMR service or application container can report the memory related error in the logs or can fail/stop with the memory related error. Identify the Hadoop service or application container that reports the error. Check the relevant logs to investigate the out of memory error.<!-- -->
<ul>
<li>Check the current service or application status to understand if the service is down or to create the timeline.  Refer the document <a href="https://repost.aws/knowledge-center/restart-service-emr" target="_blank" rel="noopener noreferrer">How do I restart a service in Amazon EMR?</a> to identify service status.</li>
<li>Following examples show how to troubleshot the out of memory issue with the Hive application, Namenode hadoop daemon and Spark application. It also demonstrate troubleshooting topics - logs to check to identify the memory errors for specific service, how to increase the heap memory of specific daemon to optimise memory usage, changing garbage collector method for optimisation and monitoring GC usage.<!-- -->
<ul>
<li>Example: Troubleshooting memory related error in Hive.<!-- -->
<ul>
<li><a href="https://repost.aws/knowledge-center/emr-hive-outofmemoryerror-heap-space" target="_blank" rel="noopener noreferrer">How do I resolve &quot;OutOfMemoryError&quot; Hive Java heap space exceptions on Amazon EMR that occur when Hive outputs the query results?</a></li>
</ul>
</li>
<li>Example: Troubleshooting memory related error in Namenode.<!-- -->
<ul>
<li><a href="https://repost.aws/knowledge-center/emr-outofmemory-gc-overhead-limit-error" target="_blank" rel="noopener noreferrer">How do I resolve the &quot;java.lang.OutOfMemoryError: GC overhead limit exceeded&quot; exception in Amazon EMR?</a></li>
</ul>
</li>
<li>Example: Handling memory related error in the Spark application,<!-- -->
<ul>
<li><a href="https://repost.aws/knowledge-center/emr-spark-yarn-memory-limit" target="_blank" rel="noopener noreferrer">How do I resolve the error &quot;Container killed by YARN for exceeding memory limits&quot; in Spark on Amazon EMR?</a></li>
<li><a href="https://repost.aws/knowledge-center/no-space-left-on-device-emr-spark" target="_blank" rel="noopener noreferrer">How do I resolve &quot;no space left on device&quot; stage failures in Spark on Amazon EMR?</a></li>
<li><a href="https://spark.apache.org/docs/latest/web-ui.html" target="_blank" rel="noopener noreferrer">Check for the GC usage from Spark UI.</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="automations-to-troubleshoot-the-emr-related-errors-automatically-or-by-querying-logs">Automations to troubleshoot the EMR related errors automatically or by querying logs<a href="#automations-to-troubleshoot-the-emr-related-errors-automatically-or-by-querying-logs" class="hash-link" aria-label="Direct link to Automations to troubleshoot the EMR related errors automatically or by querying logs" title="Direct link to Automations to troubleshoot the EMR related errors automatically or by querying logs">​</a></h2>
<ul>
<li>
<p><strong><a href="https://docs.aws.amazon.com/athena/latest/ug/emr-logs.html" target="_blank" rel="noopener noreferrer">Query Amazon EMR logs</a></strong></p>
<ul>
<li>Amazon EMR and big data applications that run on Amazon EMR produce log files. Log files are written to the <a href="https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-master-core-task-nodes.html" target="_blank" rel="noopener noreferrer">primary node</a>, and you can also configure Amazon EMR to archive log files to Amazon S3 automatically. You can use Amazon Athena to query these logs to identify events and trends for applications and clusters.</li>
</ul>
</li>
<li>
<p><strong><a href="https://repost.aws/knowledge-center/emr-spark-failure-troubleshoot-athena" target="_blank" rel="noopener noreferrer">How do I use Amazon Athena to troubleshoot when my Amazon EMR Spark jobs fail?</a></strong></p>
<ul>
<li>Article shows the step by step process to query the Spark applications logs on EMR using Athena.</li>
</ul>
</li>
<li>
<p><strong><a href="https://docs.aws.amazon.com/systems-manager-automation-runbooks/latest/userguide/automation-awssupport-analyzeemrlogs.html" target="_blank" rel="noopener noreferrer">AWSSupport-AnalyzeEMRLogs</a></strong></p>
<ul>
<li>This runbook helps identify errors while running a job on an Amazon EMR cluster. The runbook analyzes a list of defined logs on the file system and looks for a list of predefined keywords. These log entries are used to create Amazon CloudWatch Events events so you can take any needed actions based on the events. Optionally, the runbook publishes log entries to the Amazon CloudWatch Logs log group of your choosing. This runbook currently looks for the following errors and patterns in log files:</li>
<li>Error list<!-- -->
<ul>
<li><code>container_out_of_memory</code>: YARN container ran out of memory, running job may fail.</li>
<li><code>yarn_nodemanager_health</code>: CORE or TASK node is running low on disk space and will not be able to run tasks.</li>
<li><code>node_state_change</code>: CORE or TASK node is unreachable by the primary node.</li>
<li><code>step_failure</code>: An EMR Step has failed.</li>
<li><code>no_core_nodes_running</code>: No CORE nodes are currently running, cluster is unhealthy.</li>
<li><code>hdfs_missing_blocks</code>: There are missing HDFS blocks which could lead to data loss.</li>
<li><code>hdfs_high_util</code>: HDFS Utilization is high, which may affect jobs and cluster health.</li>
<li><code>instance_controller_restart</code>: Instance-Controller process has restarted. This process is essential for cluster health.</li>
<li><code>instance_controller_restart_legacy</code>: Instance-Controller process has restarted. This process is essential for cluster health.</li>
<li><code>high_load</code>: High Load Average detected, may affect node health reporting or result in timeouts or slowdowns.</li>
<li><code>yarn_node_blacklisted</code>: CORE or TASK node has been blacklisted by YARN from running tasks.</li>
<li><code>yarn_node_lost</code>: CORE or TASK node has been marked as LOST by YARN, possible connectivity issues.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong><a href="https://docs.aws.amazon.com/systems-manager-automation-runbooks/latest/userguide/awssupport-diagnose-emr-logs-with-athena.html" target="_blank" rel="noopener noreferrer">AWSSupport-DiagnoseEMRLogsWithAthena</a></strong></p>
<ul>
<li>The AWSSupport-DiagnoseEMRLogsWithAthena runbook helps diagnose Amazon EMR logs using Amazon Athena in integration with AWS Glue Data Catalog. Amazon Athena is used to query the Amazon EMR log files for containers, node logs, or both, with optional parameters for specific date ranges or keyword-based searches.</li>
<li>The runbook can automatically retrieve the Amazon EMR log location for an existing cluster, or you can specify the Amazon S3 log location.</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="enable-node-level-custom-monitoring-on-the-emr-cluster-for-troubleshooting">Enable node level custom monitoring on the EMR cluster for troubleshooting<a href="#enable-node-level-custom-monitoring-on-the-emr-cluster-for-troubleshooting" class="hash-link" aria-label="Direct link to Enable node level custom monitoring on the EMR cluster for troubleshooting" title="Direct link to Enable node level custom monitoring on the EMR cluster for troubleshooting">​</a></h2>
<ul>
<li>You can consider to enable the detailed monitoring on EMR cluster based on specific EMR version and Spark version as below.<!-- -->
<ul>
<li><a href="https://aws.amazon.com/blogs/big-data/monitor-apache-spark-applications-on-amazon-emr-with-amazon-cloudwatch/" target="_blank" rel="noopener noreferrer">Monitor Apache Spark applications on Amazon EMR with Amazon Cloudwatch</a></li>
</ul>
</li>
<li>You can consider to enable the node level monitoring for the cpu, memory and disk usage on the EMR cluster using the article  <a href="https://repost.aws/knowledge-center/emr-custom-metrics-cloudwatch" target="_blank" rel="noopener noreferrer">How can I collect custom metrics from Amazon EMR cluster instances and then monitor them in CloudWatch?</a>  After implementing the solution, you can view the node level metrics using the CloudWatch console. You can setup the <a href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/ConsoleAlarms.html" target="_blank" rel="noopener noreferrer">CloudWatch alarm</a> on cpu, memory and disk level metric as per use case. Following are examples from sample setup.<!-- -->
<ul>
<li>
<p><strong>Monitor memory usage using the CloudWatch.</strong></p>
<ul>
<li>Monitor the memory usage metrics on the cluster nodes.
<img decoding="async" loading="lazy" alt="image" src="/aws-emr-best-practices/assets/images/CWagent_disk_namespace-f62f7c486bccdfa979a11d542226a7b3.png" width="918" height="210" class="img_ev3q"></li>
<li>Example: EMR primary node shows increasing memory usage as new pyspark application are launched using the pyspark CLI and sample applications are executed.
<img decoding="async" loading="lazy" alt="image" src="/aws-emr-best-practices/assets/images/CWagent_disk_graph-d71db2b614b9b0d0972b72c467b98f82.png" width="1425" height="299" class="img_ev3q"></li>
</ul>
</li>
<li>
<p><strong>Monitor the CPU usage using CloudWatch.</strong></p>
<ul>
<li>
<p>Monitor the CPU usage metrics on the cluster nodes.</p>
<p><img decoding="async" loading="lazy" alt="image" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKQAAABnCAYAAACOyelbAAABW2lDQ1BJQ0MgUHJvZmlsZQAAKJFtkL1Lw1AUxU9rtNqKFnR0CIL4QStSuzg41A5FcIix4seWvsZUSOsjjfjxD7g4ODk4iCj4F4jFTQTRXaoiuDsKSpZa4n2tmla9cDk/Dof77ruAX9I4NyUA+YJtqakpeXFpWQ68IIh29MCPNo0VeUJRZiiCb20u5x4+oXdRMau8kxoIV0LXzxfHh2q5f/JvvqmCWb3ISD+oRxi3bMA3RKxs2FzwJnGvRUsR7wo26nwkOFPns1omrSaJb4nDLKdliR+JI5kG32jgvLnOvnYQ23fqhfk50i7qPswihjhWESUdo9v8n43XskmsgWMLFuUN5GBDRoIcDhM68TQKYBhFhFhMo8nixr9v53nbKjBBr+LE89J7wHkH0P3qeYPv9I0b4OqAa5b2c1GfIxVXxmN1DpWA1n3XfVsAAsNA9cF1KyXXrZ4CLU/ApfMJy0JisV41LDoAAABWZVhJZk1NACoAAAAIAAGHaQAEAAAAAQAAABoAAAAAAAOShgAHAAAAEgAAAESgAgAEAAAAAQAAAKSgAwAEAAAAAQAAAGcAAAAAQVNDSUkAAABTY3JlZW5zaG90DTjsTwAAAdZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDYuMC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6ZXhpZj0iaHR0cDovL25zLmFkb2JlLmNvbS9leGlmLzEuMC8iPgogICAgICAgICA8ZXhpZjpQaXhlbFlEaW1lbnNpb24+MTAzPC9leGlmOlBpeGVsWURpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjE2NDwvZXhpZjpQaXhlbFhEaW1lbnNpb24+CiAgICAgICAgIDxleGlmOlVzZXJDb21tZW50PlNjcmVlbnNob3Q8L2V4aWY6VXNlckNvbW1lbnQ+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgrQDyl7AAAaUUlEQVR4Ae1dBXwUVxMfHAIkQAyJEtwlOCnF3R1aXItb4fv6FShU0FKlWIuX4i4luLt7gBAILiGE4PLNf5JdLsldcgeE3IU3+eVu9+3b3fdm/zv73t7M/JN4eOd+TUqUBqxEA0mtpB2qGUoDogEFSAUEq9KA2YCs3ag+FStdUm980qRJqVGr5pTGzk4vUwtKA++qAbMB6Z0zB5WvWIEcnZzknACkm6cHpUqV6l3boPZXGtA1kFxfMmPh+bNnVLtxA5o1eVqU2unt7alSjWrkkCkDPX/2nHZt2UZBFwMpf+GChG2UJAllZ0Af2L2Hnjx+QkVL+FKKlClo49p/KeTuPbJLm5Z8y5Qidy8POn38JB3au59SMtA/qVyRsrq70d3bt2nDmnWUI3cuOV6KlCnlZjiwaw8FnDkrbalWtxa5ZslCL168oFPHjtPRA4ekPJuHOxVny548eXLasXkr3bp+Q9qCsvDwcNq7bSfdvXMnSn/USsJpwGwLiSZu37iZHDJmoELFikZpcUoGSMi9e7R/5x56+vQpARwQN09PKs5AS5U6FV27Ekw16telsp9+QkGBgeTo7CTLqNeqY1vK6JhJQFSmgh95eHuRH4PRO6cP7d66nW7duEmv+V2AdrwkDPDrwVepZsN65OnjjUPQy5cv6fC+A3Ql8BJVqFpZhhI+DGAMK54+eSo3COrlzp+XajaoS2dPnaYUKVLIDYZyJdahAYsA+fDhQ9qzfSf5VakoINO6AAuD8levXlLQhcAo48r7DNSt6zfSjk1bpPpW/410ZP9BuhwYRPYODvIPCxkcdIWSM0AehT+iXHnz0MOwMD5Hasrk5EhHDx6iZwx0CI63bcMm2rJ+Ay+HUN4C+aV88zp/3jecgq9ckXVnVxcqUKQQ3bh2nf5dsYoO7tkn1jFfoYL0IPQBYchx59YtypApoyzLTuojwTVg0SMbrd2/czcVLFqEqtaJsIIogyWr07gh3bh6jVKnSYOiGPLq1Sspew1Tx6J922dwkHVHZ0cpCw4KogsBARQYcIFePH9BxUr5km/Z0vT3nzOknuHH48eP5Xw4Z8de3enB/VB69OiRXsUhQwa6ffOWvo6FdOnTC/ABWMjJo8f4RopomxSojwTVgEUWUmvpmiXL5LGqrecvXIhCQ+7Twtl/07FDh7Vis76Dgy4LIG7y2M5/1VratHa9PN7xmD+4Zy9N/fl3esWPY4wfIbCmsKywbC6ZXensydPkkyuHWLk5U/+iLf9u0MF+7vQZeaRnyJhR9sU4EmPOZMmS8vBji5xvz7Ydsk19WIcGLLaQaDYegwGnz1LOvLmlF5hA1G/ehHoOHsDjtSd6zzQrqBeYWNjF40SMHTFuhGzz38TjRXfKnisnvWbr9fz5czp++KiMDTFebdWpnYz/Ll+8xO04I2D0q1KJenzZn17ypAaCcx/nm8Od3wR83rWjlOFRjzIvn+zUuU8PqfOErey0XybKdvWR8BpI8r5+OsSYLI1dGgp/GP7WvcKECZZWE1g0vOcMe/BAiqrXq0NOLk40d9oMmYVr40qtPmb0Wl2tDN8A8UsGtgZWlMECJ0mSlGf9j7GqxEo08FYW0ljbMQ57FzDimIZgxDpe4RgDGLZFByPKTNbl11XRBTNvJdangfcGyA/Rtb08k8f7SyWJVwM2Bcj7ISGJ90qonokG3mqWrXSnNBBfGlCAjC/NquO+lQYUIN9KbWqn+NKAAmR8aVYd9600oAD5VmpTO8WXBhQg40uz6rhvpQEFyLdSm9opvjRgESDz5stD06ZPoaUrFtGK1Utp4ZJ/qB77OE79axJNn/XGaRf+ir/8NoG+HDJQb7c9/6y3dPki6t2np142ZtwPUlaafSbjW/DTZouWzQjtUGK9GjAbkLnY22b02B8oI//evJk9ZWbPmkvb2VPm7t277IN4lRwdHSkDu3tBirJ7mpe3F5UrX1bW8VGx0qeULHkyOnDgoJTZpbWj3HlyS1mTpo2kLD4/smbNQq0+a0meXp7xeRp17HfUgNm/1PQf2Fe8Yzq07USh7OAaXYr7FhPQLWXXtHJ+ZaUuLGWBgvnpBIcllC5bSsp2c9gBpEnTxvK9i/0ry7C/Y0r+SfAZhz9AvLN7Uy/2xkG8zip2rgVwjx87QRvZWwfSsFEDqlKtsvzWvZK3b2AHYBf2b+zTtyctWriEj92IXDNnprPsavb7r3+Qt7cXtWn3GXalzl06UBg7/w4fOlK8iKRQfViNBsy2kK4uLnSZfReNgRGggrtX6TIRUYn58uejoEtBElZQ3q+cdNYne3a2pMFSDwWV2V3sKjv0zp0zj71uklD9hvV1pYwdP5p82EUMPxU2bdaEKrFbWrHiEWETtevUpPYc8gDPHcT4YAjg90l5ttCZqCB7gw8fMZScua2P2VEX5RHgdCVnZ2c5PjyS0rJPJay1EuvTgFmABGBwAUMMXMMMuwIwBnOMCywbJDM7zh4+fIRusrc2QOLEYQip06SmHTt2yXZ3DrzCo9+fnWmvXL4iFqs6B4lB8jOYYS1/nvArffWfodShXWcdxNhetXpVus7+mL179qOB/QfTA3ZNq23gvT5p4mTq0rEb9erRV26IQhxotmnjZpoz+2/sLsft23uABJtJgfqwKg2Y9cgG4PBvb5/eZON3Mdia86ShFEfzJUuWjLZu2S6WCNYN/5B1HGUIadW6hXznyp2TMBRAqIKLi7NYsUocrwPZw97ixsSTHW4xQVm+aolsxs2S3v7NEAJ+j5rAfY3Nr7aqvm1AA2YBEv1AYJQHg8FwrGfYvzUcpgpAdu7aiR+nL+nihYs86dlJ1dii4R/jthAOyoL4ligu47ec7BEOeR7p5d2SIwRv3LghZZgY7Yy0qFKgfXBIDqzxN8NGaiX8eH5Mbu7Z9HW1YLsaMOuRje7NnDlbYpun/jmZataqTvkQTlq7hj6TBtgAOli665GgOsYBVLCsmHAcO3pctIRXPJiszJg+izq176L/YziAyRAsK/bp06+XTGwmTv6NjdwbK3ft+nVyc8smlhhRkG7ZslGOnD5xXoFbHGEI8fMrT3kiZ/dx7qQqfHANmA1IzGRnzZjNj8f01L1HNxo15nvq1r0LlSjpqzdaA93xSPABWHcig/DXcfAWpFHjBgK4dWsiHt/aztu2bqM0HD3o6JSJxo+dINGDFT6tIOGwqPPyZcSjeNT3YyTAv3OXjvTPgrk0bMTXVLZcGX27djz9m9sAwUz/1q3bchON5vefzpEZOPR6asEqNPBWMTV4uYxJSRDPuuNbMFMeNHgAzeH3ngvmL9JPh4kTog/PnT2nl5mzkJ7DYGHJlVinBt4KkPHdlb9mTKXbnD4FVjEvJw2AtG7VRpIIxPe51fETVgNmP7I/ZDPxAjwZRxxmy5aVzpw9Sz2/6K3A+CEvQAKeyyotZALqQ506gTVglRYygXWiTp+AGlCATEDlq1PH1IACZEydqJIE1IACZAIqX506pgYUIGPqRJUkoAYUIBNQ+erUMTWgABlTJ6okATWgAJmAylenjqkBswEJnhowFxgK8jc2aNGU8hTIZ1gcYzm9g73JrGXIK47koR7eXjH2UwUfnwbMBiR4asCgkDZdWl1LpdnxAUDK6uamlxlbaNHuc6HiMLbtBWfHvXDuvIQrGNuuyj4uDZjtoAu1wJ2sIocarFq0lDPYpqQi7GhrmDAevz8XLFpY+GnAqrB3x04qxTE1SEpfqnw5BmVOWrd8pVjVY4eOUGGOkwHVCFzaUiSPyPuILLrFS5cSH8qjBw8zb80J/YqA9wY5xuEJnofZF8Bfg7zkaJcxnhpzeXKMtRt8Oko+vAbMtpBo2n6OGMzOlhIJ55EPHBlr795+QzpUlQOwQIoEvhjkBy/NzrCg7oDcQ7js5cvibOvOoajVuC48vZE/3JNjcdIxKJF6uW23zsJZAx4ZWE9DAU8NAO7s6krneDtA6RPpdW6Mp0bjtYmLJ8dYuw3Pq5Y/nAYsAuRN9tYGYRHGk+B72bh6XZSWenOkIOqAhSuEAeidw0fIkGDBkJz+OFtFTZaxb+PaZSt0wKI8T8H8Epi1mCMRAWowJkQXHHf9ytXCO/OMow5BuAQxxlOD8rh4clDHWLtRruTDa8CiRzaa5796LbXp2kn4X4I5YlATBF5hgpI2XTq2YC6cb/whkyNd0jab9Q1wGcsdbmpnMDRATPHUGO6nDS1wc0C07/fRbsPzqOV304DFgMQjGDQasE6GggsOkqInTAsCrhk8QjHeg+Dia8uG+0RfPs3JAAoXL8ach550heO6kU8c3IlxiSFPTSYOTQBVnbkSW7vNPYaq9/40YDEgcWpQuBmTnUxuWaVWDfpiUD8BYWDAeVq9ZLmM9zDmLMOz8kk//mJsVykDp+GZEyepXrPGEup6iSMXV3ImCk00q6ata9/gzDHGU2Oqvraf9m2q3dp29f3hNBAvDrqgbwP/i8RFR/YFj/PokxRT3USUIWbxllJ3mOKpMXWe6OXG2h29jlqPXw3ECyDjt8nq6IlZAxbNshOzIlTfrEMDCpDWcR1UKyI1oACpoGBVGlCAtKrLoRqjAKkwYFUaUIC0qsuhGqMAqTBgVRpQgLTwcuC3byRN/RACYgBX9mz6mEQB0sKr3aNXd/p14s+SY9LCXS2u/tMvP9Kkqb/r+1WrUZVyRbrb6YWJbCGZQ0an4YmsT/HanevXb3Di1mS0wX9jFOfk+DjpvXv3hGjg5IlTcvgx40ZJuux9e/fHx+ms4pgWOVe069CWihUrIp4+69atFzqO//5vCFN2HGfaj9KS7P5SYBCNHTNeksp37NyeXr96TX/9OUM6W7tuLSrATrWjfxgba+fBpLB1yzbavGmL1INVusdeRvPm/kM52MeyBad+9vL2kos1a+YcqdOxUzvKnCUzJUsawYXzx++TdRezLt06SWLVAA6VOHjgEPlVKE/Dvx4h+xUuUpjatv+c0trZ0bat22nx4qWxJsR3Zdc6cN5oSX0zsrNy3369yd3djULZYXkuJ9c/sP+gHNPR0Yl+HDdBzgPmCBdmh9D63pxjkdx4n8XsfW+q7cj+5sp5MB04Jqlj546Ugv0BSpYqQd/9MELYK06dPC3HTkwfZj+ywbqF7LeZIh1iwZYAQQZd5BVHKmfwzGB9xMhhsq1cubJy8WWFP0qWLMHUIXGzdhVl0CMPuSZlcRz2FIJ8P/pbys9BZQHnAigTgwHgKMJhE1myZqVrV69TGPth1qhZnapUrSz1W3/eiurUrS3pqJFotTdz2SB/OQRETyO/Gy6kTzfY06gZg6RP316yzdRHHs5XCWYJZPsFM8WUaX/I+QFGd3d3Gjr8f4T2O3Ay1U8rfqKTSdWrV1fSX2v0JI2ZSwdsFLG1HZmBy3PoB1z3PDwi4pYAStCapE6d2lQTbbrcLAuJOxQX4uyZczRowOAYHT7EsS/Dh0ZYHKR6BrtCfAi8gJCf/HzABZow/iedaAnnWsZubposWb5QwOC/foMAOfR+KLVv00k29xvQh7dVkOV6DeqK32b7Nh3l8fv1sK+oOPtjmit169WR9kydPI1WrlgtFmzR0vlsHdtIWmrcFNV53HeMnyAAL9zhqlStJPQoAJT/v/60mmOCTLVdawdoUEBlAjq/Hdt3ChmUti2xfZsFSI0tYd++uMcuRznRPRLiZ+dwhvctuKBrme2hVu2azLM4n0DY9OO4nwiPTRAo4UaAwy1oSZLyPyQLP8ZPsI+lMQGDGOqCu1GTV5G5zLX12L6zR/LyIFE/BPFBYKtwcnIU/h0k5S/DVs6Znx64Ke7ymLAkhxLDUqMvGPaAEMBU22M7d2LdZhYgz7ADLATjpLgEdaDsoKAgqZo0idmjgiiHxusVYzJpIpN/Ll5O7Tq0kWT3ABR4FrP7eNMUtlS48APYQViTp0+fClODtm74/Yq92uGz2a1LD70YlCbmSmhoqFT18vbUWSYQJozxLgRjSbA+pONHLG6Kyxzy0bRZY0rHdQIvBgp9yuAhg0y2XQ7ykX0Yv+rRlIA7HQwGsCh169WWCQUYsjSBZQJVSCX2CscY8ho/YnBhH4SFUQYOa8V7O1DJmUPfgWMCJKCnwzs4cNfYMR0cBBw5OMez588Ik5bnz1/IWAoJ+AG8ndt3yZgSCQw0wcAfFnTM+FE0+D+D9LEoth85ckzGlgAJ2mvPjsUFCxXQdo3zW7OMXZmNAk+Ebl90keMdYRYzyFIeRuBRDSu4hb3p8YhG29Cvf9k6QmJru1Qw+MCNnptJUPHqB31KjPLmysXRu2lT/hQ2BExgIGA/ALUbBNYMs0AABmCaMmmqlC9fuoL69u8t7+2gzBDmLjRHQJiEcR5ojzFR0uJ38KjDjBsDewjid6Zyu0DwCYqSOfNmyvnRBi2oa8Twb2XiAjZbTIBg1TJliohU/HPqX1SQ9wWtnUZtB45GgMccOR9wnlYuX0V169ehn34ZL7uAKm/yHxH9hxV8xJyLmADhVQ108Jg96TF+XM/jW8jChYtNtl0qGHxgiIKJzrgJY2jm9Nk8Q38T3mFQzaYXLfYYx90dzjE1sJoQjL+OsqXBpCYLX3AMwA0FIPXhVzXnzgWIFcI21PP1NT558Of3ewjSx2MYCQQuGYlcxBgtDb+mwcXXBJYIs1xj9bU6+J45ZzoDJDU1a9xSLwbQPTzdZdKGcSBm0V5eMX+NCQ9/JLyJ+o6RC+hjjpw5ZJZ///796JvjXDe37TgQOCNhzdHOxChmW0it8zdv3tQWY3xHByMqwMKdPnUmSl280unQoV2UMm0F5EvgvwEPN/6NyZ07KI+6DRfJGBg/a9NaXrdc5XhyTELwiNQel9qxQeAJYiVNGjdpSIULF9JW9e/HTx4bBST6+C7vBE21XT+xwUJiz6hhsYU00I0s4iUtXjYvWbws+iarWMejuiEnNsCbAjzK8cIdL9iVWKcG3hmQ1tkt1Spb1YBZs2xb7Zxqt+1pQAHS9q5Zom6xAmSivry21zkFSNu7Zom6xQqQifry2l7nFCBt75ol6hYrQCbqy2t7nfsoAImEpvhXYv0aMBuQ1dkZFbnALRUAAb87x7fgPI3YM8jYuZBDvC7/HKjE+jVgNiCRpdaRHU0tlUo1q1GFahHhBJbua0l9eNC4sZsbPMqV2K4GLHauQBgByJIO7N5LBThACjQeuzk4KohdrZwYsGUq+LEPZEZC9tv77G7m4eUpblcNWzZjCo81lJNDIcCeAABdvXKFNnDifLhlmTomXNty5ctLBTlOBZl7cYzkTCHiy7E57uyRc5qdIg4ZicLLlS+P0IuEsveNA8fOPGVXNSXWrwGzLaTWFQASOcArVq9Kt27cEN/EyrVqyOY6/FiEr+Jejvt4yM654WEPJWYF9B+XORoRfo1wUD178hQd2LNXgAawxXZMHLsSx6WA/eEuOwlDkEMcCfKPslMHbgAPby8U6+KS2ZVq1K8rDA9IvJ8ufTp9m1qwbg1YbCG17oCNASCBX55fpU+l+DH7Czo6O0k8C2g9IKXCylEIx5IcZABCwHWTmcM707N39iOun5l9I8E5AzF2TJ/cOWk/W+P97JwKsedoPkThgZgJaaJxjFxsdWGxNcmZN7ekjwbtCAT0JLDISqxfA28NSK1rhkFRS+bNpwpVKlNlDmeA5Zr++yStmv7dqmM7sVhgbEgTGZqgb4xc0I6JxzUsbhh7eWtin8FBFh2dHeVRH8yxOxcCArTN8m1nl1b3Mo+yQa1YvQYsfmTH1iMEXG3gqMBZHGwFb29HpuiAD6Jd5CwbTF0YZ65dtpIp5lbFOa7TKDtAFQI2LlDAXWUvcZTf5AwSoJUDBcm1K8FRmnUtOFisaBa3bPK6B2NIJbahAcssJE8+Ysqbstad2gsAMCaUMd+dO3Ti8FGqUrsG9RoykObPnCPlmMBgIvOSwfqa/2LKmzJwIcLiduXsEADiHI6D2cWTKFhgUI1Atvlv0kmacLyT7HUOprGmnCQA5wEZk5rUxNSyNZa8dwddvAd8/fpVlHQkWkirFniFUFFMdLR1cxSD94ygGjEUzPBDQ0zHsMCqvuDIRJA4KbENDbx3QNpGt1UrrVUD73UMaa2dVO2yHQ0oQNrOtfooWqoA+VFcZtvppAKk7Vyrj6KlCpAfxWW2nU4qQNrOtfooWqoA+VFcZtvppAKk7Vyrj6KlZgMyM7t0ab9Jx6YZ/GwYm5NsXNuw//uSxk0aUZu2n73T4eDcof3SFP1AKEfmM3MFSbaQo9Jc6dqtM4EoQBNkZRv53TeEfO/eBt77sbUR+yJjmimJbRv2wTU31X9Tx3yXcrN/y5487Q9ON3eNunftafR8aPS334+QhPQAVRj7Qn791TC6yI66EDA41GDvcXQwjH0lFy1Ywgk9IxJUeXl78b7f6KmOz50NoP8O+Z+4tmHbhJ/G4RC6XLhwQc9NiZzmSOJpKIMGDuE85OepCnuq27OTh8bUYFgHy/MWzKHUqd5cLCRCbd6klVRDyj/QcDixOx1+Dw9mV7tBnA8T+R5xU437cTSn8PMQX84Qzpg7ZPBXMVIRRj9fiRK+koktermpdbQfmeBWr1wjVb4ZOVR+Cr10iX0806WT1NGm2ogd+g/sxxl8y0nSVCR0nTD+Z0mDjW24Ob5k/wK45aF/yF0+dnREjktsR35O5OLUDMjFi4HUt1d/bIpXMRuQ/8xbIGmITbWmT79ekjh0DftJgn6ja/fONGrMd5KHEWwDYHDYu2cfLVywmLr36Ept2n1GqAtF4Y4HiEEf4utbnJCdtxfnDAelBoCB/IkA74PQMDm9li4aK84uToR0eivYe0gT3DjmCG6OE8dP0KGDR6T6o0fh+m6jxv4gWWqR0B6sBy1bt6BvRg6TpP9gbgAYVyxfyRYyldxo3/HN2KFdZ33/972A/JNwbkaC1rXsZQ+ZNn2KyTY2YZYHsEAcPnRE0k2DhgTWuXnTiBvu62FfST70ib9NolKc9xwsF0jWumD+IsnQ239gX7rKepwza64YhmzZsr3vLhk93v8BK4aV6xa/V0gAAAAASUVORK5CYII=" width="164" height="103" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="image" src="/aws-emr-best-practices/assets/images/CWagent_cpu_metric_list-a9be8f00507187e208bfcdf83cb7b2c7.png" width="555" height="184" class="img_ev3q"></p>
</li>
<li>
<p>Example: EMR primary node shows increasing CPU usage when user runs CPU bound application on the primary node. Following graphs shows continuous reduction in “cpu_usage_idle“ and increased in ”cpu_usage_user“ metrics due to the higher user application usage.
<img decoding="async" loading="lazy" alt="image" src="/aws-emr-best-practices/assets/images/CWagent_cpu_graph-b6e17824eb7bd2b31b9625f9f3e84487.png" width="1374" height="513" class="img_ev3q"></p>
</li>
</ul>
</li>
<li>
<p><strong>Monitor the disk usage using CloudWatch.</strong></p>
<ul>
<li>Monitor the disk usage metrics on the cluster nodes. You can filter the disk usage based on the file system.
<img decoding="async" loading="lazy" alt="image" src="data:image/png;base64,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" width="151" height="110" class="img_ev3q"></li>
<li>Example: EMR primary node shows increasing disk usage as disks are being filled for the filesystem “nvme0n1p1”.
<img decoding="async" loading="lazy" alt="image" src="/aws-emr-best-practices/assets/images/CWagent_memory_graph-9d7d6e19d8918d4f82d03d4082f01c46.png" width="1392" height="626" class="img_ev3q"></li>
<li>Example: Primary node disk usage.<!-- -->
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ df -h </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Filesystem      Size  Used Avail Use% Mounted on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/dev/nvme0n1p1   15G   15G   20K 100% </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="additional-steps-to-troubleshoot">Additional steps to troubleshoot<a href="#additional-steps-to-troubleshoot" class="hash-link" aria-label="Direct link to Additional steps to troubleshoot" title="Direct link to Additional steps to troubleshoot">​</a></h2>
<p>If issues persist after following the steps mentioned in this guide, contact AWS Support for further assistance, ensuring you include all relevant logs and diagnostic information gathered during your troubleshooting process to expedite resolution. You can reference the section <a href="#troubleshot-logs-on-emr">Troubleshot logs on EMR</a> to identify relevant logs or reference to share with the AWS Support.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/bestpractices/Troubleshooting/Troubleshooting EMR.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/aws-emr-best-practices/docs/bestpractices/Security/best_practices"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Best Practices</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight"><strong><strong>Overview</strong></strong></a></li><li><a href="#getting-started" class="table-of-contents__link toc-highlight">Getting Started</a></li><li><a href="#addressing-common-emr-cluster-errors-and-known-issues" class="table-of-contents__link toc-highlight">Addressing Common EMR Cluster Errors and Known Issues</a><ul><li><a href="#amazon-q-for-emr-troubleshooting" class="table-of-contents__link toc-highlight">Amazon Q for EMR troubleshooting</a></li><li><a href="#troubleshot-logs-on-emr" class="table-of-contents__link toc-highlight">Troubleshot logs on EMR</a></li></ul></li><li><a href="#troubleshooting-disk-space-related-issues-on-emr" class="table-of-contents__link toc-highlight">Troubleshooting Disk space related issues on EMR</a><ul><li><a href="#check-the-cluster-level-hdfs-related-metrics-to-understand-if-there-is-a-cluster-level-space-issue-and-how-to-troubleshoot-it" class="table-of-contents__link toc-highlight">Check the cluster level HDFS related metrics to understand if there is a cluster level space issue and how to troubleshoot it.</a></li><li><a href="#check-the-cluster-level-metrics-to-understand-if-there-is-a-disk-related-issue-at-node-level-and-how-to-troubleshoot-it" class="table-of-contents__link toc-highlight">Check the cluster level metrics to understand if there is a disk related issue at node level and how to troubleshoot it.</a></li></ul></li><li><a href="#troubleshooting-cpu-related-issues-on-emr" class="table-of-contents__link toc-highlight">Troubleshooting CPU related issues on EMR</a><ul><li><a href="#review-the-node-level-logs-and-metrics-to-understand-the-cpu-usage" class="table-of-contents__link toc-highlight">Review the node level logs and metrics to understand the CPU usage</a></li><li><a href="#review-load-average-metric-to-understand-the-cpu-usage" class="table-of-contents__link toc-highlight">Review <code>load average</code> metric to understand the CPU usage</a></li><li><a href="#review-diskio-metric-to-understand-the-cpu-usage" class="table-of-contents__link toc-highlight">Review diskio metric to understand the CPU usage</a></li></ul></li><li><a href="#troubleshooting-memory-related-issues-on-emr" class="table-of-contents__link toc-highlight">Troubleshooting memory related issues on EMR</a><ul><li><a href="#reviewing-memory-usage" class="table-of-contents__link toc-highlight">Reviewing memory usage</a></li><li><a href="#troubleshooting-a-memory-related-issue" class="table-of-contents__link toc-highlight">Troubleshooting a memory related issue</a></li></ul></li><li><a href="#automations-to-troubleshoot-the-emr-related-errors-automatically-or-by-querying-logs" class="table-of-contents__link toc-highlight">Automations to troubleshoot the EMR related errors automatically or by querying logs</a></li><li><a href="#enable-node-level-custom-monitoring-on-the-emr-cluster-for-troubleshooting" class="table-of-contents__link toc-highlight">Enable node level custom monitoring on the EMR cluster for troubleshooting</a></li><li><a href="#additional-steps-to-troubleshoot" class="table-of-contents__link toc-highlight">Additional steps to troubleshoot</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Contributing</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/aws/aws-emr-best-practices/tree/main" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Built with ❤️ at AWS  <br> © 2024 Amazon.com, Inc. or its affiliates. All Rights Reserved</div></div></div></footer></div>
</body>
</html>